Cell-SSL-MultiTask-Detection/
│
├── README.md                       # 專案介紹、安裝、使用方式
├── .gitignore                      # 忽略 data / logs / checkpoints / cache
├── requirements.txt                # Python 套件需求 (torch, timm, kornia, albumentations, etc.)
│
├── configs/                        # 訓練 / 推論 設定檔
│   ├── ssl.yaml                    # SSL (DINO-style) 預訓練設定
│   ├── classifier.yaml             # 陽性/陰性分類設定
│   ├── segmentation.yaml           # UNet segmentation 設定
│   ├── detector_rtdetr.yaml        # 未來 RT-DETR 偵測設定
│   └── pipeline.yaml               # 最終 inference pipeline 統一設定
│
├── data/                           # (ignored) 原始與處理後資料
│   ├── ssl_images/                 # 未標註影像 (SSL 用)
│   ├── ssl_pt/                     # 預處理後 .pt tensors (SSL 加速用)
│   ├── classification/             # 分類資料
│   │   ├── train/
│   │   │   ├── positive/
│   │   │   └── negative/
│   │   └── val/
│   │       ├── positive/
│   │       └── negative/
│   ├── segmentation/              # segmentation 影像 + mask
│   │   ├── images/
│   │   └── masks/
│   └── detection/                 # bounding box annotations (e.g. COCO/VOC)
│
├── logs/                           # (ignored) TensorBoard / training logs
│   ├── ssl/
│   ├── classifier/
│   ├── segmentation/
│   └── detector/
│
├── checkpoints/                    # (ignored) 儲存各階段權重
│   ├── ssl_pretrain.pth            # SSL 預訓練後 student 模型
│   ├── ssl_encoder_only.pth        # export 後的 encoder (for downstream)
│   ├── classifier_best.pth         # 最佳陽/陰分類器
│   ├── segmentor_best.pth          # 最佳 segmentation 模型
│   └── detector_best.pth           # 未來偵測模型 (RT-DETR / others)
│
├── src/
│   ├── datasets/
│   │   ├── ssl_dataset.py          # SSL 用 Dataset（讀 raw images 或 .pt）
│   │   ├── ssl_dataset_pt.py       # 專讀 ssl_pt/ 下 .pt tensors 的 Dataset
│   │   ├── cls_dataset.py          # 陽/陰分類 Dataset (ImageFolder)
│   │   ├── seg_dataset.py          # segmentation Dataset (image + mask)
│   │   ├── det_dataset.py          # detection Dataset (boxes / COCO 格式)
│   │   └── transforms/             # augmentation 都集中在這裡
│   │       ├── ssl_aug.py          # SSL 強增強（GPU / Kornia）
│   │       ├── cls_aug.py          # 分類專用 aug
│   │       ├── seg_aug.py          # segmentation 專用 aug
│   │       └── det_aug.py          # detection 專用 aug
│   │
│   ├── models/
│   │   ├── backbone.py             # 共用 ResNet-50 / Encoder
│   │   ├── ssl_dino.py             # Teacher/Student + projection heads
│   │   ├── ssl_loss.py             # DINO-style SSL loss
│   │   ├── classifier.py           # Binary classifier (MLP head)
│   │   ├── segmentor_unet.py       # UNet / FPN-style segmentation head
│   │   ├── detector_rtdetr_wrapper.py # 預留: RT-DETR backbone+head 包裝
│   │   ├── multitask_wrapper.py    # backbone + classifier + segmentor (+ detector)
│   │   └── init_weights.py         # 權重初始化 / load_pretrained helper
│   │
│   ├── training/
│   │   ├── train_ssl.py            # SSL 預訓練主程式 (DINO)
│   │   ├── train_classifier.py     # 陽/陰分類訓練
│   │   ├── train_segmentor.py      # segmentation 訓練
│   │   ├── train_detector.py       # 未來偵測訓練
│   │   └── train_utils.py          # 共用: optimizer, scheduler, EMA, seed, AMP
│   │
│   ├── inference/
│   │   ├── infer_classifier.py     # 單張/資料夾分類
│   │   ├── infer_detector.py       # 單張/資料夾偵測 (未來)
│   │   ├── infer_segmentation.py   # 單張 segmentation mask 預測
│   │   └── infer_pipeline.py       # 完整 pipeline:
│   │                              #   image → SSL backbone → classifier
│   │                              #   → (若 positive) → detector + segmentor
│   │
│   ├── utils/
│   │   ├── logger.py               # logging & TensorBoard/CSV writer
│   │   ├── metric_seg.py           # segmentation metrics (Dice, IoU, etc.)
│   │   ├── metric_cls.py           # classification metrics (Acc, F1, AUC)
│   │   ├── metric_det.py           # detection metrics (mAP, etc. 之後用)
│   │   ├── visualize.py            # 視覺化: cls result、bbox、mask overlay
│   │   ├── load_ssl_backbone.py    # 從 ssl_pretrain.pth 載入 encoder 的工具
│   │   └── common.py               # 其他共用函式 (seed 設定、path util 等)
│   │
│   └── runners/                    # 對使用者友善的一鍵執行入口
│       ├── run_ssl.py              # 讀 ssl.yaml → 呼叫 training/train_ssl.py
│       ├── run_classifier.py       # 讀 classifier.yaml → train classifier
│       ├── run_segmentor.py        # 讀 segmentation.yaml → train segmentor
│       ├── run_detector.py         # 讀 detector_rtdetr.yaml → train detector
│       └── run_pipeline.py         # inference pipeline: 分類→偵測→分割
│
└── scripts/
    ├── prepare_data.py             # 切 train/val/test, 建立 classification 結構
    ├── preprocess_to_pt.py         # raw ssl_images → ssl_pt/*.pt (加速 SSL)
    ├── convert_masks.py            # mask 格式/顏色轉換 (e.g. PNG ↔ label map)
    ├── export_ssl_encoder.py       # 從 ssl_pretrain.pth 匯出 encoder-only
    └── visualize_results.py        # 批次畫出預測結果 (bbox + mask overlay)

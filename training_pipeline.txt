Training Pipeline for SSL + Classification + Detection + Segmentation

1. SSL Pretraining Stage
   - Input: Unlabeled microscopy images (train set only)
   - Process:
       a. Apply strong DINO-style augmentations (v1, v2)
       b. Forward student backbone on v1, teacher backbone on v2
       c. Compute DINO loss (alignment + uniformity)
       d. Update student weights; EMA update teacher
   - Output: ssl_pretrain.pth (student backbone weights)

2. Classification Training Stage (Positive/Negative)
   - Input:
       - Labeled classification dataset (train/val)
       - Frozen SSL student backbone
   - Process:
       a. Feature extraction using frozen backbone
       b. Train MLP classifier head:
           - GAP → Linear → ReLU → Linear(2)
       c. Optimize only classifier head
   - Output: cell_classifier_best.pth

3. Detection Training Stage (Positive Samples Only)
   - Input:
       - Annotated bounding boxes (positive images only)
       - Frozen SSL backbone (or partially fine-tuned)
   - Process:
       a. Use SSL backbone as shared encoder
       b. Attach detection head (e.g., RetinaNet/YOLO-style head)
       c. Train detection head on positive images
   - Output: detector_best.pth

4. Segmentation Training Stage
   - Input:
       - Annotated segmentation masks (positive images, small subset)
       - Frozen SSL backbone as encoder
   - Process:
       a. Attach UNet/FPN decoder to backbone
       b. Train only decoder on segmentation dataset
   - Output: segmentor_best.pth

5. Multi‑Task Integration (Optional)
   - Package:
       ssl_backbone.pth
       classifier_best.pth
       detector_best.pth
       segmentor_best.pth

6. Final Inference Pipeline (not training)
   - test image → SSL backbone
   - → classifier
       • if negative → output Negative
       • if positive → detector + segmentation → final output
